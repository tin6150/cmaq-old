head     1.1;
branch   1.1.1;
access   ;
symbols  CMAQv4_5_1:1.1.1.1 ASMD:1.1.1;
locks    ; strict;
comment  @c @;


1.1
date     2006.03.13.19.27.27;  author sjr;  state Exp;
branches 1.1.1.1;
next     ;

1.1.1.1
date     2006.03.13.19.27.27;  author sjr;  state Exp;
branches ;
next     ;


desc
@@



1.1
log
@Initial revision
@
text
@
C***********************************************************************
C   Portions of Models-3/CMAQ software were developed or based on      *
C   information from various groups: Federal Government employees,     *
C   contractors working on a United States Government contract, and    *
C   non-Federal sources (including research institutions).  These      *
C   research institutions have given the Government permission to      *
C   use, prepare derivative works, and distribute copies of their      *
C   work in Models-3/CMAQ to the public and to permit others to do     *
C   so.  EPA therefore grants similar permissions for use of the       *
C   Models-3/CMAQ software, but users are requested to provide copies  *
C   of derivative works to the Government without restrictions as to   *
C   use by others.  Users are responsible for acquiring their own      *
C   copies of commercial software associated with Models-3/CMAQ and    *
C   for complying with vendor requirements.  Software copyrights by    *
C   the MCNC Environmental Modeling Center are used with their         *
C   permissions subject to the above restrictions.                     *
C***********************************************************************


C RCS file, release, date & time of last delta, author, state, [and locker]
C $Header: /project/work/rep/PDM/src/trans/trans/move.F,v 1.8 2005/08/29 20:34:27 jug Exp $ 

C what(1) key, module and SID; SCCS file; date and time of last delta:
C %W% %P% %G% %U%

C********************************************************************
      SUBROUTINE MOVE( IHI, ILOW, IDTSEC, SUMX, SUMY, XDDEL, U, V, ZF,
     &                 AWNDSP )
C********************************************************************

C** FUNCTION: Compute the ave. wind speed and plume travel distance.

      USE VGRD_DEFN

      IMPLICIT NONE

      INCLUDE SUBST_IOPARMS
      INCLUDE SUBST_IOFDESC
!      INCLUDE SUBST_VGRD_ID

      INTEGER IHI, ILOW, IDTSEC
      REAL SUMX, SUMY, XDDEL
      REAL U( NLAYS ), V( NLAYS ), ZF( 0:NLAYS ), AWNDSP

      INTEGER K, ILO
      REAL DZ( NLAYS ), UU( NLAYS ), VV( NLAYS )
      REAL WNDSP, DELTA, AWDIR

C Initialize variables.
      AWNDSP = 0.0
      SUMX = 0.0
      SUMY = 0.0

C Find vertical extent spanned by the plume
      ILO = MAX( 1,ILOW )
      IF ( ILO .GT. IHI ) ILO = IHI
      DELTA = ZF( IHI ) - ZF( ILO-1 )

C Get thickness of each layer
      DO K = 1, NLAYS
         DZ( K ) = ZF( K ) - ZF( K-1 )
      END DO

C  Sum the wind components over the layers of the plume
C  weight the layer wind speeds by the layer thickness.
!     write( *,* ) 'IN MOVE', ILO, IHI, DELTA
      DO K = ILO, IHI
         UU( K ) = U( K ) * ( DZ( K ) / DELTA )
         VV( K ) = V( K ) * ( DZ( K ) / DELTA )
         WNDSP = SQRT( UU( K ) * UU( K ) + VV( K ) * VV( K ) )
         AWNDSP = AWNDSP + WNDSP
         SUMX = SUMX + UU( K )
         SUMY = SUMY + VV( K )
!        write( *,* ) 'MOVE: ', K, ZF( K-1 ), DZ( K ), DZ( K )/DELTA, SUMX, SUMY, AWNDSP
      END DO

      SUMX = 0.001 * FLOAT( IDTSEC ) * SUMX
      SUMY = 0.001 * FLOAT( IDTSEC ) * SUMY
      XDDEL = 0.001* FLOAT( IDTSEC ) * AWNDSP
      AWDIR = 270.0 - ATAN2( SUMY, SUMX ) * 180.0 / 3.14159

!     write( *,* ) AWDIR, AWNDSP, XDDEL

      RETURN
      END
@


1.1.1.1
log
@CMAQv4_5_1 release
@
text
@@
