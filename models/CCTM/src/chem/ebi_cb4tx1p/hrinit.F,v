head     1.1;
branch   1.1.1;
access   ;
symbols  CMAQv4_5_1:1.1.1.1 ASMD:1.1.1;
locks    ; strict;
comment  @c @;


1.1
date     2006.03.15.20.43.47;  author sjr;  state Exp;
branches 1.1.1.1;
next     ;

1.1.1.1
date     2006.03.15.20.43.47;  author sjr;  state Exp;
branches ;
next     ;


desc
@@



1.1
log
@Initial revision
@
text
@
C***********************************************************************
C   Portions of Models-3/CMAQ software were developed or based on      *
C   information from various groups: Federal Government employees,     *
C   contractors working on a United States Government contract, and    *
C   non-Federal sources (including research institutions).  These      *
C   research institutions have given the Government permission to      *
C   use, prepare derivative works, and distribute copies of their      *
C   work in Models-3/CMAQ to the public and to permit others to do     *
C   so.  EPA therefore grants similar permissions for use of the       *
C   Models-3/CMAQ software, but users are requested to provide copies  *
C   of derivative works to the Government without restrictions as to   *
C   use by others.  Users are responsible for acquiring their own      *
C   copies of commercial software associated with Models-3/CMAQ and    *
C   for complying with vendor requirements.  Software copyrights by    *
C   the MCNC Environmental Modeling Center are used with their         *
C   permissions subject to the above restrictions.                     *
C***********************************************************************

C RCS file, release, date & time of last delta, author, state, [and locker]
C $Header: /project/work/rep/CCTM/src/chem/ebi_cb4tx1p/hrinit.F,v 1.1.1.1 2005/09/01 20:22:46 sjr Exp $ 

C what(1) key, module and SID; SCCS file; date and time of last delta:
C %W% %P% %G% %U%


      SUBROUTINE HRINIT
C***********************************************************************
C
C  FUNCTION: To initialize species tolerances, arrays, and indices
C
C  PRECONDITIONS: For the CB4TX1P family of mechanisms
C
C  RETURN VALUES: None
C
C  KEY SUBROUTINES/FUNCTIONS CALLED: None
C
C  REVISION HISTORY: Created by EBI solver program, Aug. 30, 2005
C                    30 Aug 05  WTH: added variable used by degrade routines
C
C***********************************************************************

      USE HRDATA

      IMPLICIT NONE

C.....INCLUDES:
      INCLUDE SUBST_GC_SPC    ! Gas chem species names and MWs
      INCLUDE SUBST_GC_EMIS   ! Gas chem emissions name and mapping tables
      INCLUDE SUBST_RXCMMN    ! Mechanism reaction common block

C.....ARGUMENTS: NONE

C.....PARAMETERS: NONE


C.....EXTERNAL FUNCTIONS:
      INTEGER  FINDEX         ! Finds location of a number in a list

C.....SAVED VARIABLES:
      CHARACTER( 16 ), SAVE  ::  PNAME = 'HRINIT'   ! Program name


C.....LOCAL VARIABLES:
      CHARACTER*132 MSG       ! Log message

      INTEGER IND             ! Species index
      INTEGER N               ! Loop index

C***********************************************************************

      N_SPEC = N_GC_SPC
      N_RXNS = NRXNS

      ALLOCATE( RKI( NRXNS ) )
      ALLOCATE( RXRAT( NRXNS ) )
      ALLOCATE( RTOL( N_SPEC) )
      ALLOCATE( YC(   N_SPEC) )
      ALLOCATE( YC0(  N_SPEC) )
      ALLOCATE( YCP(  N_SPEC) )
      ALLOCATE( PROD( N_SPEC) )
      ALLOCATE( LOSS( N_SPEC) )
      ALLOCATE( YCCELL( MODEL_SPECIES) )  ! WTH: array for degradation routines
      ALLOCATE( PNEG( N_SPEC) )

      NING1 = 4
      NING2 = 4



cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
c  Set species indices for gas-phase only version
cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
      IF( .NOT. L_AQ_VRSN .AND. .NOT. L_AE_VRSN ) THEN

         NO2               =   1
         NO                =   2
         O                 =   3
         O3                =   4
         NO3               =   5
         O1D               =   6
         OH                =   7
         HO2               =   8
         N2O5              =   9
         HNO3              =  10
         HONO              =  11
         PNA               =  12
         H2O2              =  13
         CO                =  14
         FORM              =  15
         ALD2              =  16
         C2O3              =  17
         XO2               =  18
         PAN               =  19
         PACD              =  20
         PAR               =  21
         XO2N              =  22
         ROR               =  23
         NTR               =  24
         OLE               =  25
         FACD              =  26
         AACD              =  27
         ETH               =  28
         ALD2_SUR          =  29
         TOL               =  30
         CRES              =  31
         TO2               =  32
         OPEN              =  33
         CRO               =  34
         XYL               =  35
         MGLY              =  36
         ISOP              =  37
         ISPD              =  38
         SO2               =  39
         SULF              =  40
         UMHP              =  41
         ACROLEIN          =  42
         BUTADIENE13       =  43
         FORM_SUR          =  44
         FORM_PRIMARY      =  45
         ALD2_PRIMARY      =  46
         ACROLEIN_PRIMARY  =  47

         N_EBISP  =  34
         ALLOCATE( EBISP( N_EBISP ) ) 

         EBISP(   1 ) = HNO3
         EBISP(   2 ) = H2O2
         EBISP(   3 ) = CO
         EBISP(   4 ) = FORM
         EBISP(   5 ) = ALD2
         EBISP(   6 ) = XO2
         EBISP(   7 ) = PACD
         EBISP(   8 ) = PAR
         EBISP(   9 ) = XO2N
         EBISP(  10 ) = ROR
         EBISP(  11 ) = NTR
         EBISP(  12 ) = OLE
         EBISP(  13 ) = FACD
         EBISP(  14 ) = AACD
         EBISP(  15 ) = ETH
         EBISP(  16 ) = ALD2_SUR
         EBISP(  17 ) = TOL
         EBISP(  18 ) = CRES
         EBISP(  19 ) = TO2
         EBISP(  20 ) = OPEN
         EBISP(  21 ) = CRO
         EBISP(  22 ) = XYL
         EBISP(  23 ) = MGLY
         EBISP(  24 ) = ISOP
         EBISP(  25 ) = ISPD
         EBISP(  26 ) = SO2
         EBISP(  27 ) = SULF
         EBISP(  28 ) = UMHP
         EBISP(  29 ) = ACROLEIN
         EBISP(  30 ) = BUTADIENE13
         EBISP(  31 ) = FORM_SUR
         EBISP(  32 ) = FORM_PRIMARY
         EBISP(  33 ) = ALD2_PRIMARY
         EBISP(  34 ) = ACROLEIN_PRIMARY

      ENDIF


cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
c  Set species indices for gas-phase plus aerosol only version
cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
      IF( L_AE_VRSN .AND. .NOT. L_AQ_VRSN ) THEN

         NO2               =   1
         NO                =   2
         O                 =   3
         O3                =   4
         NO3               =   5
         O1D               =   6
         OH                =   7
         HO2               =   8
         N2O5              =   9
         HNO3              =  10
         HONO              =  11
         PNA               =  12
         H2O2              =  13
         CO                =  14
         FORM              =  15
         ALD2              =  16
         C2O3              =  17
         XO2               =  18
         PAN               =  19
         PACD              =  20
         PAR               =  21
         XO2N              =  22
         ROR               =  23
         NTR               =  24
         OLE               =  25
         FACD              =  26
         AACD              =  27
         ETH               =  28
         ALD2_SUR          =  29
         TOL               =  30
         CRES              =  31
         TO2               =  32
         TOLAER            =  33
         OPEN              =  34
         CRO               =  35
         CSLAER            =  36
         XYL               =  37
         MGLY              =  38
         XYLAER            =  39
         ISOP              =  40
         ISPD              =  41
         SO2               =  42
         SULF              =  43
         SULAER            =  44
         UMHP              =  45
         ACROLEIN          =  46
         BUTADIENE13       =  47
         FORM_SUR          =  48
         FORM_PRIMARY      =  49
         ALD2_PRIMARY      =  50
         ACROLEIN_PRIMARY  =  51
         TERP              =  52
         TERPAER           =  53

         N_EBISP  =  40
         ALLOCATE( EBISP( N_EBISP ) ) 

         EBISP(   1 ) = HNO3
         EBISP(   2 ) = H2O2
         EBISP(   3 ) = CO
         EBISP(   4 ) = FORM
         EBISP(   5 ) = ALD2
         EBISP(   6 ) = XO2
         EBISP(   7 ) = PACD
         EBISP(   8 ) = PAR
         EBISP(   9 ) = XO2N
         EBISP(  10 ) = ROR
         EBISP(  11 ) = NTR
         EBISP(  12 ) = OLE
         EBISP(  13 ) = FACD
         EBISP(  14 ) = AACD
         EBISP(  15 ) = ETH
         EBISP(  16 ) = ALD2_SUR
         EBISP(  17 ) = TOL
         EBISP(  18 ) = CRES
         EBISP(  19 ) = TO2
         EBISP(  20 ) = TOLAER
         EBISP(  21 ) = OPEN
         EBISP(  22 ) = CRO
         EBISP(  23 ) = CSLAER
         EBISP(  24 ) = XYL
         EBISP(  25 ) = MGLY
         EBISP(  26 ) = XYLAER
         EBISP(  27 ) = ISOP
         EBISP(  28 ) = ISPD
         EBISP(  29 ) = SO2
         EBISP(  30 ) = SULF
         EBISP(  31 ) = SULAER
         EBISP(  32 ) = UMHP
         EBISP(  33 ) = ACROLEIN
         EBISP(  34 ) = BUTADIENE13
         EBISP(  35 ) = FORM_SUR
         EBISP(  36 ) = FORM_PRIMARY
         EBISP(  37 ) = ALD2_PRIMARY
         EBISP(  38 ) = ACROLEIN_PRIMARY
         EBISP(  39 ) = TERP
         EBISP(  40 ) = TERPAER

      ENDIF


cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
c  Set species indices for gas-phase plus AQ chemistry version
cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
      IF( .NOT. L_AE_VRSN .AND. L_AQ_VRSN ) THEN

         NO2               =   1
         NO                =   2
         O                 =   3
         O3                =   4
         NO3               =   5
         O1D               =   6
         OH                =   7
         HO2               =   8
         N2O5              =   9
         HNO3              =  10
         HONO              =  11
         PNA               =  12
         H2O2              =  13
         CO                =  14
         FORM              =  15
         ALD2              =  16
         C2O3              =  17
         XO2               =  18
         PAN               =  19
         PACD              =  20
         PAR               =  21
         XO2N              =  22
         ROR               =  23
         NTR               =  24
         OLE               =  25
         FACD              =  26
         AACD              =  27
         ETH               =  28
         ALD2_SUR          =  29
         TOL               =  30
         CRES              =  31
         TO2               =  32
         OPEN              =  33
         CRO               =  34
         XYL               =  35
         MGLY              =  36
         ISOP              =  37
         ISPD              =  38
         SO2               =  39
         SULF              =  40
         UMHP              =  41
         ACROLEIN          =  42
         BUTADIENE13       =  43
         FORM_SUR          =  44
         FORM_PRIMARY      =  45
         ALD2_PRIMARY      =  46
         ACROLEIN_PRIMARY  =  47

         N_EBISP  =  34
         ALLOCATE( EBISP( N_EBISP ) ) 

         EBISP(   1 ) = HNO3
         EBISP(   2 ) = H2O2
         EBISP(   3 ) = CO
         EBISP(   4 ) = FORM
         EBISP(   5 ) = ALD2
         EBISP(   6 ) = XO2
         EBISP(   7 ) = PACD
         EBISP(   8 ) = PAR
         EBISP(   9 ) = XO2N
         EBISP(  10 ) = ROR
         EBISP(  11 ) = NTR
         EBISP(  12 ) = OLE
         EBISP(  13 ) = FACD
         EBISP(  14 ) = AACD
         EBISP(  15 ) = ETH
         EBISP(  16 ) = ALD2_SUR
         EBISP(  17 ) = TOL
         EBISP(  18 ) = CRES
         EBISP(  19 ) = TO2
         EBISP(  20 ) = OPEN
         EBISP(  21 ) = CRO
         EBISP(  22 ) = XYL
         EBISP(  23 ) = MGLY
         EBISP(  24 ) = ISOP
         EBISP(  25 ) = ISPD
         EBISP(  26 ) = SO2
         EBISP(  27 ) = SULF
         EBISP(  28 ) = UMHP
         EBISP(  29 ) = ACROLEIN
         EBISP(  30 ) = BUTADIENE13
         EBISP(  31 ) = FORM_SUR
         EBISP(  32 ) = FORM_PRIMARY
         EBISP(  33 ) = ALD2_PRIMARY
         EBISP(  34 ) = ACROLEIN_PRIMARY

      ENDIF


cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
c  Set species indices for gas-phase plus  aerosol plus AQ chem version
cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
      IF( L_AE_VRSN .AND. L_AQ_VRSN ) THEN

         NO2               =   1
         NO                =   2
         O                 =   3
         O3                =   4
         NO3               =   5
         O1D               =   6
         OH                =   7
         HO2               =   8
         N2O5              =   9
         HNO3              =  10
         HONO              =  11
         PNA               =  12
         H2O2              =  13
         CO                =  14
         FORM              =  15
         ALD2              =  16
         C2O3              =  17
         XO2               =  18
         PAN               =  19
         PACD              =  20
         PAR               =  21
         XO2N              =  22
         ROR               =  23
         NTR               =  24
         OLE               =  25
         FACD              =  26
         AACD              =  27
         ETH               =  28
         ALD2_SUR          =  29
         TOL               =  30
         CRES              =  31
         TO2               =  32
         TOLAER            =  33
         OPEN              =  34
         CRO               =  35
         CSLAER            =  36
         XYL               =  37
         MGLY              =  38
         XYLAER            =  39
         ISOP              =  40
         ISPD              =  41
         SO2               =  42
         SULF              =  43
         SULAER            =  44
         UMHP              =  45
         ACROLEIN          =  46
         BUTADIENE13       =  47
         FORM_SUR          =  48
         FORM_PRIMARY      =  49
         ALD2_PRIMARY      =  50
         ACROLEIN_PRIMARY  =  51
         TERP              =  52
         TERPAER           =  53

         N_EBISP  =  40
         ALLOCATE( EBISP( N_EBISP ) ) 

         EBISP(   1 ) = HNO3
         EBISP(   2 ) = H2O2
         EBISP(   3 ) = CO
         EBISP(   4 ) = FORM
         EBISP(   5 ) = ALD2
         EBISP(   6 ) = XO2
         EBISP(   7 ) = PACD
         EBISP(   8 ) = PAR
         EBISP(   9 ) = XO2N
         EBISP(  10 ) = ROR
         EBISP(  11 ) = NTR
         EBISP(  12 ) = OLE
         EBISP(  13 ) = FACD
         EBISP(  14 ) = AACD
         EBISP(  15 ) = ETH
         EBISP(  16 ) = ALD2_SUR
         EBISP(  17 ) = TOL
         EBISP(  18 ) = CRES
         EBISP(  19 ) = TO2
         EBISP(  20 ) = TOLAER
         EBISP(  21 ) = OPEN
         EBISP(  22 ) = CRO
         EBISP(  23 ) = CSLAER
         EBISP(  24 ) = XYL
         EBISP(  25 ) = MGLY
         EBISP(  26 ) = XYLAER
         EBISP(  27 ) = ISOP
         EBISP(  28 ) = ISPD
         EBISP(  29 ) = SO2
         EBISP(  30 ) = SULF
         EBISP(  31 ) = SULAER
         EBISP(  32 ) = UMHP
         EBISP(  33 ) = ACROLEIN
         EBISP(  34 ) = BUTADIENE13
         EBISP(  35 ) = FORM_SUR
         EBISP(  36 ) = FORM_PRIMARY
         EBISP(  37 ) = ALD2_PRIMARY
         EBISP(  38 ) = ACROLEIN_PRIMARY
         EBISP(  39 ) = TERP
         EBISP(  40 ) = TERPAER

      ENDIF


cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
c  Set species tolerances
cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
      RTOL( NO2              ) = 1.0E-03
      RTOL( NO               ) = 1.0E-03
      RTOL( O                ) = 1.0E+00
      RTOL( O3               ) = 1.0E-03
      RTOL( NO3              ) = 1.0E-03
      RTOL( O1D              ) = 1.0E+00
      RTOL( OH               ) = 1.0E-03
      RTOL( HO2              ) = 1.0E-03
      RTOL( N2O5             ) = 1.0E-03
      RTOL( HNO3             ) = 1.0E-03
      RTOL( HONO             ) = 1.0E-03
      RTOL( PNA              ) = 1.0E-03
      RTOL( H2O2             ) = 1.0E-03
      RTOL( CO               ) = 1.0E-03
      RTOL( FORM             ) = 1.0E-03
      RTOL( ALD2             ) = 1.0E-03
      RTOL( C2O3             ) = 1.0E-03
      RTOL( XO2              ) = 1.0E-03
      RTOL( PAN              ) = 1.0E-03
      RTOL( PACD             ) = 1.0E-03
      RTOL( PAR              ) = 1.0E-03
      RTOL( XO2N             ) = 1.0E-03
      RTOL( ROR              ) = 1.0E-03
      RTOL( NTR              ) = 1.0E+00
      RTOL( OLE              ) = 1.0E-03
      RTOL( FACD             ) = 1.0E-03
      RTOL( AACD             ) = 1.0E-03
      RTOL( ETH              ) = 1.0E-03
      RTOL( ALD2_SUR         ) = 1.0E-03
      RTOL( TOL              ) = 1.0E-03
      RTOL( CRES             ) = 1.0E-03
      RTOL( TO2              ) = 1.0E-03
      RTOL( OPEN             ) = 1.0E-03
      RTOL( CRO              ) = 1.0E-03
      RTOL( XYL              ) = 1.0E-03
      RTOL( MGLY             ) = 1.0E-03
      RTOL( ISOP             ) = 1.0E-03
      RTOL( ISPD             ) = 1.0E-03
      RTOL( SO2              ) = 1.0E-03
      RTOL( SULF             ) = 1.0E+00
      RTOL( UMHP             ) = 1.0E-03
      RTOL( ACROLEIN         ) = 1.0E-03
      RTOL( BUTADIENE13      ) = 1.0E-03
      RTOL( FORM_SUR         ) = 1.0E-03
      RTOL( FORM_PRIMARY     ) = 1.0E-03
      RTOL( ALD2_PRIMARY     ) = 1.0E-03
      RTOL( ACROLEIN_PRIMARY ) = 1.0E-03

      IF( L_AE_VRSN ) THEN

         RTOL( TOLAER           ) = 1.0E+00
         RTOL( CSLAER           ) = 1.0E+00
         RTOL( XYLAER           ) = 1.0E+00
         RTOL( SULAER           ) = 1.0E+00
         RTOL( TERP             ) = 1.0E+00
         RTOL( TERPAER          ) = 1.0E+00

      ENDIF


      RETURN

      END
@


1.1.1.1
log
@CMAQv4_5_1 release
@
text
@@
