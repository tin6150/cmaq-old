
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>
<!-- "$Id: SMATVEC.html 90 2015-01-14 22:35:22Z coats $" -->
<META NAME="MSSmartTagsPreventParsing" CONTENT="TRUE"> 
<TITLE> SMATVEC() </TITLE>
</HEAD>

<BODY BGCOLOR="#FFFFFF" 
      TOPMARGIN="15" 
      MARGINHEIGHT="15" 
      LEFTMARGIN="15" 
      MARGINWIDTH="15">

<H1>    SMATVEC() </H1>

<H2> Fortran version: </H2>
<PRE>
    SUBROUTINE SMATVEC( NCOLS, NROWS, NCOFF, N, I, C, U, V )
      INTEGER, INTENT(IN   ) :: NCOLS           ! length of input vector
      INTEGER, INTENT(IN   ) :: NROWS           ! length of output vector
      INTEGER, INTENT(IN   ) :: NCOFF           ! max number of coefficients
      INTEGER, INTENT(IN   ) :: N( NROWS )      ! number of entries per row
      INTEGER, INTENT(IN   ) :: I( NCOFF )      ! columns list
      REAL   , INTENT(IN   ) :: C( NCOFF )      ! coefficient array
      REAL   , INTENT(IN   ) :: U( NCOLS )      !  input vector
      REAL   , INTENT(  OUT) :: V( NROWS )      ! output vector
</PRE><P> 

<H2> C version:  none </H2>

<H2> Summary: </H2>

     <CODE>SMATVEC()</CODE> multiplies input vector <CODE>U</CODE>  by
    sparse matrix  <CODE>&lt;N,I,C&gt; </CODE> and returns the
    resulting output vector <CODE>V</CODE>, as is  done in area-source
    gridding.
    <BLOCKQUOTE>
        <VAR>C(R)</VAR> =  
        <STRONG>SUM<SUB>K=N(R-1)-1</SUB><SUP>N(R)</SUP></STRONG> 
                           <VAR>C(K) U(I(K))</VAR>
    </BLOCKQUOTE>

    For Fortran-90 declarations and interface checking:    
    <PRE>
    <A HREF = "M3UTILIO.html">USE M3UTILIO</A>
    </PRE><P>
    
    See also subroutines
    <BLOCKQUOTE>
    <A HREF = "BMATVEC.html">BMATVEC and BILIN</A>,
    <A HREF = "DMATVEC.html">DMATVEC</A>,
    <A HREF = "PMATVEC.html">PMATVEC</A>, and
    <A HREF = "UNGRIDB.html">UNGRIDB</A>
    </BLOCKQUOTE>
    and programs
    <BLOCKQUOTE>
    <A HREF = "MTXBLEND.html">MTXBLEND</A>,
    <A HREF = "MTXBUILD.html">MTXBUILD</A>,
    <A HREF = "MTXCALC.html">MTXCALC</A>,
    <A HREF = "MTXCPLE.html">MTXCPLE</A>.
    </BLOCKQUOTE>
    <P> 


<H2> Fortran Usage: </H2>
    
<PRE>
    !!  Multiply ABUF(NC1,NR1) by MATX to get ZBUF(NC2,NR2)
    ...
    INTEGER :: NR,  NC    !!  for matrix
    INTEGER :: NR1, NC1      !!  for input grid
    INTEGER :: NR2, NC2      !!  for input grid
    INTEGER, ALLOCATABLE :: MATX(:)
    INTEGER, ALLOCATABLE :: MCNT(:)
    REAL,    ALLOCATABLE :: ABUF(:,:)
    REAL,    ALLOCATABLE :: ZBUF(:,:)
    ...
    !!  [Get dimensions (NC1,NR1), (NC2,NR2) for input and output grids]
    ...
    IF ( DESC3( MTXFILE ) ) THEN
        NR = NROWS3D
        NC = NCOLS3D
    ...
    IF ( NR .NE. NC2*NR2 )...   !!  consistency-check for dimensions
    ...
    ALLOCATE( MATX( NR+2*NC ),  &amp;
              MCNT( 0:NR ),     &amp;
              ABUF(NC1,NR1),    &amp;
              ZBUF(NC2,NR2), STAT=ISTAT )
    ...
    IF ( .NOT.READ3( MTXFILE, ALLVAR3, 1,0,0, MATX ) ) ...
    ...
    IF ( .NOT.READ3( DATAFILE, 'FOO', 1,0,0, ABUF ) ) ...
    ...
    CALL SMATVEC( NC1*NR1, NR, NCOEF,                   &amp;
                  MATX(1), MATX(NR+1), MATX(NC+NR+1),   &amp;
                  ABUF, ZBUF )
    ...
    !!  or equivalently, for a time-stepped input:
    ...  
</PRE><P> 


<HR> <!----------------------------------------------------------------->
    
<A HREF = "SETENV.html" >
Previous:  <STRONG>SETENV</STRONG>
</A><P> 

<A HREF = "SORTI.html" >
Next:  <STRONG>SORTI</STRONG>
</A><P> 

<A HREF = "AA.html#utility"> 
Up: <STRONG>Utility Routines</STRONG> 
</A><P> 

<A HREF = "AA.html"> 
To: <STRONG>Models-3/EDSS I/O API:   The Help Pages</STRONG> 
</A><P> 

</BODY>
</HTML>

